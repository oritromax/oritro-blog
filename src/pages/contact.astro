---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Contact - Nidal Siddique Oritro">
  <div class="max-w-2xl mx-auto p-4 lg:p-8">
    <div class="text-center mb-12">
      <h1 class="text-3xl font-bold mb-4">Let's Connect</h1>
      <a 
        href="/consultation"
        class="inline-block py-2 px-4 bg-emerald-400/10 text-emerald-400 rounded-lg font-medium hover:bg-emerald-400/20 transition-colors"
      >
        How I Consult
      </a>
    </div>
    
    <!-- Form -->
    <div class="relative">
      <div class="absolute inset-0 bg-gradient-to-r from-emerald-400/10 to-purple-400/20 rounded-xl -rotate-1"></div>
      <div class="absolute inset-0 border border-white/10 rounded-xl rotate-1"></div>
      <form 
        id="consultForm"
        class="relative bg-gray-800/50 p-6 rounded-xl space-y-6"
      >
        <!-- Name -->
        <div>
          <label for="name" class="block text-sm font-medium text-gray-300 mb-2">Name</label>
          <input
            type="text"
            id="name"
            name="name"
            required
            class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-emerald-400 text-white"
          />
        </div>

        <!-- Email -->
        <div>
          <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email</label>
          <input
            type="email"
            id="email"
            name="email"
            required
            class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-emerald-400 text-white"
          />
        </div>

        <!-- Consultation Type -->
        <div>
          <label class="block text-sm font-medium text-gray-300 mb-2">Consult About</label>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="radio" name="consultType" value="Building A Team" required class="text-emerald-400 bg-gray-900 border-gray-700 focus:ring-emerald-400 focus:ring-offset-gray-900" />
              <span class="ml-2 text-gray-300">Building A Team</span>
            </label>
            <label class="flex items-center">
              <input type="radio" name="consultType" value="Software Architecture" required class="text-emerald-400 bg-gray-900 border-gray-700 focus:ring-emerald-400 focus:ring-offset-gray-900" />
              <span class="ml-2 text-gray-300">Software Architecture</span>
            </label>
            <label class="flex items-center">
              <input type="radio" name="consultType" value="Technical Crisis" required class="text-emerald-400 bg-gray-900 border-gray-700 focus:ring-emerald-400 focus:ring-offset-gray-900" />
              <span class="ml-2 text-gray-300">Technical Crisis</span>
            </label>
            <label class="flex items-center">
              <input type="radio" name="consultType" value="Developing Team Management" required class="text-emerald-400 bg-gray-900 border-gray-700 focus:ring-emerald-400 focus:ring-offset-gray-900" />
              <span class="ml-2 text-gray-300">Developing Team Management</span>
            </label>
          </div>
        </div>

        <!-- Message -->
        <div>
          <label for="message" class="block text-sm font-medium text-gray-300 mb-2">Message</label>
          <textarea
            id="message"
            name="message"
            rows="4"
            required
            class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-emerald-400 text-white"
          ></textarea>
        </div>

        <!-- Submit Button -->
        <div class="relative">
          <div class="absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-purple-400/20 rounded-xl -rotate-1"></div>
          <div class="absolute inset-0 border border-white/10 rounded-xl rotate-1"></div>
          <button
            type="submit"
            class="relative w-full py-3 px-6 bg-gray-800 hover:bg-gray-700 rounded-xl font-medium transition-all hover:scale-[1.02]"
          >
            Send Message
          </button>
        </div>

        <!-- Response Messages -->
        <div id="successMessage" class="hidden p-4 bg-emerald-400/10 border border-emerald-400/20 rounded-lg text-emerald-400">
          Your submission has been received, an email will be dispatched to schedule a meeting and further details
        </div>
        <div id="errorMessage" class="hidden p-4 bg-red-400/10 border border-red-400/20 rounded-lg text-red-400">
          Something wrong, please try again
        </div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById('consultForm');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');

    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Hide any existing messages
      successMessage?.classList.add('hidden');
      errorMessage?.classList.add('hidden');

      try {
        const formData = new FormData(form);
        const response = await fetch('https://n8n.homelab.ioritro.com/webhook/ac4d77f7-cdd0-41b3-904c-3a61d4840be7', {
          method: 'POST',
          body: JSON.stringify(Object.fromEntries(formData)),
          headers: {
            'Content-Type': 'application/json',
          },
        });

        if (response.ok) {
          successMessage?.classList.remove('hidden');
          form.reset();
        } else {
          errorMessage?.classList.remove('hidden');
        }
      } catch (error) {
        errorMessage?.classList.remove('hidden');
      }
    });
  </script>
</Layout>